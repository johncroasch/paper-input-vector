
<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../paper-input/paper-input.html">
<link rel="import" href="../paper-styles/typography.html">
<link rel="import" href="../iron-validator-behavior/iron-validator-behavior.html">

<dom-module id="paper-input-vector">
  <template>
    <style>
	div {
	  @apply(--paper-font-common-base);
	}
	paper-input {
		--paper-input-container-invalid-color: var(--google-red-500);
    }
	</style>
	<!-- no content allowed -->
    <content select=".content"></content>
	<div>
		{{label}}
		<table style="width:100%"><tr id="table_row">
			<td><paper-input error-message="{{errorMessage}}" id="input1" label="{{labelComp1}}" always-float-label placeholder="enter..."><div suffix>{{units}}</div></paper-input></td>
			<td>&nbsp;&nbsp;&nbsp;</td>
			<td><paper-input error-message="{{errorMessage}}" id="input2" label="{{labelComp2}}" always-float-label placeholder="enter..."><div suffix>{{units}}</div></paper-input></td>
			<td id="table_cell3_space">&nbsp;&nbsp;&nbsp;</td>
			<td id="table_cell3"><paper-input error-message="{{errorMessage}}" id="input3" label="{{labelComp3}}" always-float-label placeholder="enter..."><div suffix>{{units}}</div></paper-input></td>
			<td id="table_cell4_space">&nbsp;&nbsp;&nbsp;</td>
			<td id="table_cell4"><paper-input error-message="{{errorMessage}}" id="input4" label="{{labelComp4}}" always-float-label placeholder="enter..."><div suffix>{{units}}</div></paper-input></td>
		</tr></table>
	</div>
  </template>
</dom-module>

<script>
Polymer ( {
    is: 'paper-input-vector',
	setValue: function ( vector ) {
		for ( var i=0 ; i<vector.length ; i++ ) {
			this.vector[i] = vector[i];
		}
	},
	ready: function() {
		var row = this.$.table_row;
		
		// remove unnecessary elements
		if ( this.dimension < 4 ) {
			Polymer.dom(row).removeChild(this.$.table_cell4);
			Polymer.dom(row).removeChild(this.$.table_cell4_space);
		}
		if ( this.dimension < 3 ) {
			Polymer.dom(row).removeChild(this.$.table_cell3);
			Polymer.dom(row).removeChild(this.$.table_cell3_space);
		}
		
		// customize input behavior
		for ( var d=1 ; d<=this.dimension ; d++ )
		{
			var input = this.$['input'+d];
			input.preventInvalidInput = true;
			if ( this.type == 'Integer' )
				input.allowedPattern = '[0-9+-]';
			else if ( this.type == 'Float' )
				input.allowedPattern = '[.0-9e+-]';
			
			input.autoValidate = true;
			input.validator = "number-validator";
		}
	},
    behaviors: [
        Polymer.IronValidatorBehavior
    ],
	validatorName:"number-validator",
	validate: function ( values ) {
		if ( this.type == 'Float' ) {
			if ( !isNaN(Number(values) ) ) return true;
		}
		return false;
	},
    properties: {
		vector: {type:Array, value:[0,0,0,0]},
		normalized: {type:Boolean , value:false},
		label: {type:String, value:'vector input' },
		dimension: {type:Number, value:3 },
		units: {type:String, value:'' },
		errorMessage: {type:String, value:'Invalid Input' },
		type: {type:String, value:'Float' }, /* allowed values: Integer, Float */
		labelComp1: {type:String, value:'component 1' },
		labelComp2: {type:String, value:'component 2' },
		labelComp3: {type:String, value:'component 3' },
		labelComp4: {type:String, value:'component 4' }
	}
  });
</script>
